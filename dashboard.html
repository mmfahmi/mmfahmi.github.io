<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Dashboard: Automated OTP Relay Phishing</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F4F0; /* Creamy Off-White */
            color: #4A4A4A; /* Dark Slate Gray */
            scroll-behavior: smooth;
        }
        .header-main { color: #5D737E; } /* Dusty Blue/Slate */
        .header-secondary { color: #6a838e; }
        .accent-color-1 { color: #E5989B; } /* Dusty Rose */
        .accent-bg-1 { background-color: #E5989B; }
        .accent-border-1 { border-color: #E5989B; }
        .bg-complementary-light { background-color: #A8DADC; } /* Pale Cyan/Aqua */
        .border-complementary-light { border-color: #A8DADC; }
        .text-complementary { color: #5D737E; }
        .bg-card { background-color: #FFFFFF; }
        .border-subtle { border-color: #D1D5DB; } /* Tailwind gray-300 */

        .dashboard-card {
            background-color: #FFFFFF;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06); /* shadow-md */
            padding: 1.5rem; /* p-6 */
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .stat-highlight {
            font-size: 2.75rem; /* Custom large size */
            line-height: 1.1;
            font-weight: 700; /* bold */
            color: #5D737E; /* Dusty Blue/Slate */
        }
        .flow-step {
            background-color: #FFFFFF;
            border: 2px solid #A8DADC; /* Pale Cyan/Aqua */
            min-height: 6rem;
        }
        .flow-arrow {
            color: #5D737E;
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px; /* Adjusted for smaller dashboard cards */
            margin-left: auto;
            margin-right: auto;
            height: 250px; /* Adjusted for dashboard */
            max-height: 350px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 280px;
                max-width: 550px;
            }
        }
        @media (min-width: 1024px) {
            .chart-container {
                height: 300px; /* Slight increase for larger screens */
            }
        }
    </style>
</head>
<body class="antialiased leading-relaxed">

    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <header class="text-center py-8 md:py-12 bg-gradient-to-br from-[#A8DADC] to-[#d1e8e8] rounded-xl shadow-lg mb-8">
            <h1 class="text-3xl md:text-4xl font-bold header-main mb-2">Automated OTP Relay Phishing</h1>
            <p class="text-lg md:text-xl text-gray-700 max-w-2xl mx-auto">Interactive Threat Intelligence Dashboard</p>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">

            <div class="dashboard-card lg:col-span-1 flex flex-col justify-between">
                <h2 class="text-2xl font-semibold header-main mb-4">Threat Overview</h2>
                <p class="text-gray-700 mb-4">
                    Automated OTP Relay Phishing bypasses MFA by intercepting credentials and OTPs in real-time. This dashboard presents key insights into its mechanisms, impact, and defenses.
                </p>
                <div class="space-y-4">
                    <div class="p-4 bg-gray-50 rounded-lg border-l-4 accent-border-1 shadow-sm">
                        <p class="stat-highlight accent-color-1">$4.88M</p>
                        <p class="text-gray-700 text-sm font-medium">Avg. Annual Cost of Phishing Breach [IBM 2024]</p>
                    </div>
                    <div class="p-4 bg-gray-50 rounded-lg border-l-4 accent-border-1 shadow-sm">
                        <p class="stat-highlight accent-color-1">74%</p>
                        <p class="text-gray-700 text-sm font-medium">Of incidents involve human error [Report [83]]</p>
                    </div>
                </div>
            </div>

            <div class="dashboard-card lg:col-span-2">
                <h2 class="text-2xl font-semibold header-main mb-4">Attack Mechanism: AiTM Flow</h2>
                <p class="text-gray-700 mb-4">
                    Adversary-in-the-Middle (AiTM) attacks use reverse proxies to seamlessly intercept the entire authentication process, including MFA, stealing session cookies for unauthorized access.
                </p>
                <div class="bg-gray-50 p-4 rounded-lg border border-subtle flex-grow flex items-center justify-center">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-3 md:gap-4 items-stretch text-center text-xs sm:text-sm w-full max-w-4xl">
                        <div class="flow-step rounded-md p-2 flex flex-col items-center justify-center shadow-sm">
                            <span class="text-xl mb-1">①</span>Victim clicks phishing link.
                        </div>
                        <div class="hidden md:flex items-center justify-center flow-arrow text-2xl font-bold">➔</div>
                        <div class="flow-step rounded-md p-2 flex flex-col items-center justify-center md:col-start-1 md:row-start-2 mt-3 md:mt-0 shadow-sm">
                           <span class="text-xl mb-1">④</span>Proxy relays OTP to real site; captures session cookie.
                        </div>
                         <div class="flex md:hidden items-center justify-center flow-arrow text-2xl font-bold transform rotate-90 my-2">⬇</div>
                        <div class="flow-step rounded-md p-2 flex flex-col items-center justify-center shadow-sm">
                            <span class="text-xl mb-1">②</span>Redirected to Attacker's Proxy. Enters credentials.
                        </div>
                         <div class="hidden md:flex items-center justify-center flow-arrow text-2xl font-bold transform rotate-180 md:col-start-2 md:row-start-2">⬅</div>
                        <div class="flex md:hidden items-center justify-center flow-arrow text-2xl font-bold transform rotate-90 my-2">⬇</div>
                        <div class="flow-step rounded-md p-2 flex flex-col items-center justify-center md:col-start-4 md:row-start-1 shadow-sm">
                           <span class="text-xl mb-1">③</span>Proxy relays to real site; MFA prompted. Victim enters OTP.
                        </div>
                        <div class="hidden md:flex items-center justify-center flow-arrow text-2xl font-bold transform rotate-180 md:col-start-3 md:row-start-2">⬅</div>
                        <div class="flex md:hidden items-center justify-center flow-arrow text-2xl font-bold transform rotate-90 my-2">⬇</div>
                         <div class="flow-step rounded-md p-2 flex flex-col items-center justify-center md:col-start-4 md:row-start-2 shadow-sm">
                            <span class="text-xl mb-1">⑤</span>Attacker uses cookie for access.
                        </div>
                    </div>
                </div>
            </div>

            <div class="dashboard-card lg:col-span-2">
                <h2 class="text-2xl font-semibold header-main mb-4">PhaaS Explorer: Platforms & Features</h2>
                <p class="text-gray-700 mb-4">
                    Phishing-as-a-Service (PhaaS) platforms lower the barrier for sophisticated attacks. Select a platform to view its details or explore common features.
                </p>
                <div class="grid md:grid-cols-2 gap-6 flex-grow">
                    <div class="flex flex-col">
                        <label for="phaas-selector" class="block text-gray-700 text-sm font-medium mb-2">Select PhaaS Platform:</label>
                        <select id="phaas-selector" class="block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-accent-color-1 focus:border-accent-color-1 sm:text-sm">
                            <option value="Evilginx2">Evilginx2</option>
                            <option value="Mamba 2FA">Mamba 2FA</option>
                            <option value="Astaroth">Astaroth</option>
                            <option value="Darcula">Darcula</option>
                            <option value="Tycoon 2FA">Tycoon 2FA</option>
                            <option value="Lucid">Lucid</option>
                        </select>
                        <div id="phaas-details" class="mt-4 p-4 bg-gray-50 rounded-lg border border-subtle flex-grow">
                            <h3 class="font-semibold text-lg text-gray-800" id="phaas-name">Evilginx2</h3>
                            <p class="text-sm text-gray-600 mt-2" id="phaas-description">Open-source reverse proxy tool for phishing attacks, known for session hijacking and obtaining valid SSL certificates.</p>
                            <p class="text-sm text-gray-600 mt-2"><strong class="text-gray-800">MFA Bypass:</strong> <span id="phaas-mfa-bypass-value">Yes</span></p>
                            <p class="text-sm text-gray-600 mt-2"><strong class="text-gray-800">Key Features:</strong> <span id="phaas-features-value">Session hijacking, valid SSL, open-source.</span></p>
                        </div>
                    </div>
                    <div class="flex flex-col justify-end">
                        <h3 class="text-lg font-semibold header-secondary mb-3">Common PhaaS Features</h3>
                        <div class="chart-container flex-grow">
                            <canvas id="phaasFeaturesChart"></canvas>
                        </div>
                        <p class="text-xs text-gray-500 mt-2 text-center">Prevalence of key capabilities in PhaaS offerings. (Conceptual data)</p>
                    </div>
                </div>
            </div>

            <div class="dashboard-card lg:col-span-1">
                <h2 class="text-2xl font-semibold header-main mb-4">Impact & Risk</h2>
                <p class="text-gray-700 mb-4">
                    Automated phishing leads to significant financial losses and reputational damage. Understanding the cost components and human factors is crucial.
                </p>
                <div class="flex-grow flex flex-col justify-center items-center gap-6">
                    <div class="chart-container h-64 w-full">
                        <canvas id="costBreakdownChart"></canvas>
                    </div>
                    <p class="text-xs text-gray-500 text-center">Conceptual breakdown of data breach cost components.</p>
                </div>
            </div>

            <div class="dashboard-card lg:col-span-1">
                <h2 class="text-2xl font-semibold header-main mb-4">Defense Strategies</h2>
                <p class="text-gray-700 mb-4">
                    A multi-layered defense is essential against these advanced threats. Prioritize phishing-resistant MFA, real-time detection, Zero Trust, and continuous education.
                </p>
                <ul class="space-y-3 text-sm text-gray-700 flex-grow">
                    <li><strong class="text-gray-800">1. Phishing-Resistant MFA:</strong> FIDO/WebAuthn, PKI-based.</li>
                    <li><strong class="text-gray-800">2. Real-time Detection:</strong> Browser-based security, AI-driven solutions, automated threat intelligence.</li>
                    <li><strong class="text-gray-800">3. Zero Trust Architecture:</strong> Continuous verification, least privilege, microsegmentation.</li>
                    <li><strong class="text-gray-800">4. Employee Education:</strong> Training on modern social engineering, simulated phishing.</li>
                </ul>
            </div>

            <div class="dashboard-card lg:col-span-1">
                <h2 class="text-2xl font-semibold header-main mb-4">Case Study Highlights</h2>
                <p class="text-gray-700 mb-4">
                    Real-world incidents underscore the severe consequences of automated phishing.
                </p>
                <ul class="space-y-4 text-sm text-gray-700 flex-grow">
                    <li>
                        <strong class="text-gray-800">Mamba 2FA Campaign (July 2024):</strong> Bypassed MS365 MFA, leading to fraudulent mailbox rules.
                    </li>
                    <li>
                        <strong class="text-gray-800">Pepco Group Attack (Feb 2024):</strong> Lost ~€15.5M due to AI-crafted phishing emails.
                    </li>
                    <li>
                        <strong class="text-gray-800">LabHost PhaaS Platform (2021-2024):</strong> Caused >£100M in fraud, impacted 1M+ victims.
                    </li>
                </ul>
            </div>

            <div class="dashboard-card lg:col-span-3">
                <h2 class="text-2xl font-semibold header-main mb-4">Future Outlook</h2>
                <p class="text-gray-700 mb-4">
                    The threat landscape will continue to evolve, with AI playing an increasing role in creating hyper-personalized attacks and more convincing deepfakes. Quantum computing also poses a long-term risk to current encryption.
                </p>
                <div class="grid md:grid-cols-3 gap-6">
                    <div class="p-4 bg-gray-50 rounded-lg border-l-4 border-complementary-light shadow-sm">
                        <p class="stat-highlight text-complementary">78%</p>
                        <p class="text-gray-700 text-sm font-medium">Open rate for AI-generated phishing emails.</p>
                    </div>
                    <div class="p-4 bg-gray-50 rounded-lg border-l-4 border-complementary-light shadow-sm">
                        <p class="stat-highlight text-complementary">50%</p>
                        <p class="text-gray-700 text-sm font-medium">AI predicted to reduce exploit time for exposures by 2027.</p>
                    </div>
                    <div class="p-4 bg-gray-50 rounded-lg border-l-4 border-complementary-light shadow-sm">
                        <p class="text-gray-700 font-medium"><strong class="text-lg text-complementary">Quantum Threat</strong></p>
                        <p class="text-gray-600 text-sm">Future risk to current encryption ("Harvest Now, Decrypt Later").</p>
                    </div>
                </div>
            </div>

        </main>

        <footer class="text-center py-6 mt-8 border-t border-gray-200">
            <p class="text-sm text-gray-500">Interactive dashboard based on the report: "The Evolving Threat of Automated OTP Relay Phishing: Mechanisms, Impact, and Advanced Defenses."</p>
            <p class="text-xs text-gray-400 mt-1">All data and insights are sourced from the provided report. Citations [N] refer to sources within that original document.</p>
        </footer>

    </div>

    <script>
        // Data for PhaaS Explorer
        const phaasPlatforms = {
            "Evilginx2": {
                description: "An open-source reverse proxy tool for phishing attacks, widely recognized for its effectiveness in session hijacking and obtaining valid SSL certificates. It serves as a foundational tool for many advanced phishing campaigns.",
                mfaBypass: "Yes",
                features: "Session hijacking, valid SSL, open-source, highly customizable."
            },
            "Mamba 2FA": {
                description: "A prominent PhaaS platform specifically targeting Microsoft 365. It utilizes Socket.IO for real-time MFA token relay, allowing attackers to intercept credentials and MFA codes instantly. It also includes sandbox detection capabilities.",
                mfaBypass: "Yes",
                features: "Targets MS365, real-time MFA relay (Socket.IO), sandbox detection, stealthy."
            },
            "Astaroth": {
                description: "A sophisticated reverse proxy PhaaS platform known for its session hijacking capabilities and use of bulletproof hosting to resist takedowns. It also features mechanisms for reCAPTCHA bypass, making it harder for victims to prove they are not bots.",
                mfaBypass: "Yes",
                features: "Session hijacking, bulletproof hosting, reCAPTCHA bypass, robust infrastructure."
            },
            "Darcula": {
                description: "A PhaaS platform that offers one-click brand impersonation and deep cloning capabilities, allowing threat actors to quickly create highly convincing phishing pages. It integrates AI for generating more compelling content and adapting to defenses.",
                mfaBypass: "Yes",
                features: "One-click brand impersonation, deep cloning, AI integration, adaptable templates."
            },
            "Tycoon 2FA": {
                description: "Another platform primarily targeting Microsoft 365, known for its advanced anti-analysis and code obfuscation techniques. It often leverages Cloudflare Turnstile for bot detection, making it more challenging for security researchers to analyze.",
                mfaBypass: "Yes",
                features: "Targets MS365, Cloudflare Turnstile, anti-analysis, code obfuscation."
            },
            "Lucid": {
                description: "A newer PhaaS platform distinguished by its use of iMessage and RCS for smishing (SMS phishing) attacks. It boasts advanced anti-detection mechanisms, making its campaigns difficult to trace and block.",
                mfaBypass: "Yes (via session hijacking)",
                features: "iMessage/RCS smishing, advanced anti-detection, quick setup."
            }
        };

        // Utility function to wrap chart labels
        function wrapChartLabels(labels, maxWidth = 16) {
            return labels.map(label => {
                if (typeof label !== 'string' || label.length <= maxWidth) {
                    return label;
                }
                const words = label.split(' ');
                const lines = [];
                let currentLine = '';
                words.forEach(word => {
                    if ((currentLine + word).length > maxWidth && currentLine.length > 0) {
                        lines.push(currentLine.trim());
                        currentLine = word + ' ';
                    } else {
                        currentLine += word + ' ';
                    }
                });
                if (currentLine.trim().length > 0) {
                    lines.push(currentLine.trim());
                }
                return lines;
            });
        }

        // Common Chart.js options for dashboard consistency
        const commonDashboardChartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    labels: { color: '#4A4A4A' }
                },
                title: {
                    display: true,
                    color: '#5D737E',
                    font: { size: 14, weight: '600' } // Slightly smaller for dashboard cards
                },
                tooltip: {
                    callbacks: {
                        title: function(tooltipItems) {
                            const item = tooltipItems[0];
                            if (!item || !item.chart || !item.chart.data || !item.chart.data.labels) return '';
                            let label = item.chart.data.labels[item.dataIndex];
                            if (Array.isArray(label)) {
                                return label.join(' ');
                            }
                            return label || '';
                        }
                    }
                }
            },
            scales: {
                x: { 
                    ticks: { color: '#4A4A4A' }, 
                    grid: { color: '#E5E7EB' }
                },
                y: { 
                    ticks: { color: '#4A4A4A' }, 
                    grid: { color: '#E5E7EB' }
                }
            }
        };

        // PhaaS Features Chart
        const phaasFeaturesCtx = document.getElementById('phaasFeaturesChart');
        let phaasFeaturesChart;
        if (phaasFeaturesCtx) {
            phaasFeaturesChart = new Chart(phaasFeaturesCtx.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: wrapChartLabels(['One-click Impersonation', 'Hosting & Distribution', 'Dynamic URL Gen.', 'Anti-Detection/Evasion', 'Real-time Monitoring']),
                    datasets: [{
                        label: 'Feature Prevalence',
                        data: [90, 85, 80, 95, 75], // Conceptual data from report
                        backgroundColor: ['#A8DADC', '#E5989B', '#F4A261', '#87CEEB', '#FFB6C1'],
                        borderColor: '#FFFFFF',
                        borderWidth: 1
                    }]
                },
                options: {
                    ...commonDashboardChartOptions,
                    indexAxis: 'y',
                    plugins: { 
                        ...commonDashboardChartOptions.plugins, 
                        legend: { display: false },
                        title: { ...commonDashboardChartOptions.plugins.title, text: 'Common PhaaS Platform Features' }
                    },
                    scales: {
                        x: { ...commonDashboardChartOptions.scales.x, max:100, beginAtZero: true},
                        y: { ...commonDashboardChartOptions.scales.y, ticks: { ...commonDashboardChartOptions.scales.y.ticks, autoSkip: false } }
                    }
                }
            });
        }

        // Cost Breakdown Chart
        const costBreakdownCtx = document.getElementById('costBreakdownChart');
        let costBreakdownChart;
        if (costBreakdownCtx) {
            costBreakdownChart = new Chart(costBreakdownCtx.getContext('2d'), {
                type: 'doughnut',
                data: {
                    labels: wrapChartLabels(['Lost Business', 'Detection & Escalation', 'Post-Breach Response', 'Notification Costs']),
                    datasets: [{
                        label: 'Cost Components',
                        data: [38, 29, 27, 6], // Conceptual data based on IBM reports structure
                        backgroundColor: ['#E5989B', '#A8DADC', '#F4A261', '#BFD8D2'],
                        borderColor: '#FFFFFF',
                        borderWidth: 2
                    }]
                },
                options: {
                    ...commonDashboardChartOptions,
                    plugins: {
                        ...commonDashboardChartOptions.plugins,
                        title: { ...commonDashboardChartOptions.plugins.title, text: 'Data Breach Cost Breakdown (Conceptual)'},
                        legend: { ...commonDashboardChartOptions.plugins.legend, position: 'bottom', labels: { boxWidth: 10, padding: 8 } }
                    }
                }
            });
        }

        // PhaaS Selector Logic
        const phaasSelector = document.getElementById('phaas-selector');
        const phaasName = document.getElementById('phaas-name');
        const phaasDescription = document.getElementById('phaas-description');
        // Get the span elements directly to update their text content, avoiding nextSibling
        const phaasMfaBypassValue = document.getElementById('phaas-mfa-bypass-value');
        const phaasFeaturesValue = document.getElementById('phaas-features-value');

        function updatePhaasDetails() {
            const selectedPlatform = phaasSelector.value;
            const data = phaasPlatforms[selectedPlatform];
            if (data) {
                if (phaasName) phaasName.textContent = selectedPlatform;
                if (phaasDescription) phaasDescription.textContent = data.description;
                if (phaasMfaBypassValue) phaasMfaBypassValue.textContent = data.mfaBypass;
                if (phaasFeaturesValue) phaasFeaturesValue.textContent = data.features;
            }
        }

        if (phaasSelector) {
            phaasSelector.addEventListener('change', updatePhaasDetails);
            // Initial load to display default selection
            updatePhaasDetails();
        }
    </script>
</body>
</html>
